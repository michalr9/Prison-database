--skrypt instalujacy DB Oracle
--Michal Raczkowski 
--grupa K5X3S1

CREATE TABLE DETALE_ROZLICZENIA
  (
    ID_ROZLICZENIA   			 NUMBER (6) NOT NULL ,
    POZYCJA                      NUMBER (2) NOT NULL ,
    ID_UDOGODNIENIA				 NUMBER (3) NOT NULL ,
    LICZBA_UDOGODNIEN            NUMBER (2) ,
    CENA_ZA_UDOGODNIENIA         NUMBER (6,2) NOT NULL 
  ) ;
ALTER TABLE DETALE_ROZLICZENIA ADD CONSTRAINT DETALE_ROZLICZENIA_PK PRIMARY KEY ( ID_ROZLICZENIA, POZYCJA ) ;


CREATE TABLE PLACOWKA
  (
    ID_PLACOWKI    NUMBER (6) NOT NULL ,
    NAZWA_PLACOWKI VARCHAR2 (40) NOT NULL ,
    ULICA          VARCHAR2 (25) ,
    MIEJSCOWOSC    VARCHAR2 (30) ,
    KRAJ           VARCHAR2 (30)
  ) ;
ALTER TABLE PLACOWKA ADD CONSTRAINT PLACOWKA_PK PRIMARY KEY ( ID_PLACOWKI ) ;


CREATE TABLE PRACA
  (
    ID_PRACY               NUMBER (6) NOT NULL ,
    CZAS_PRACY_DZ          NUMBER (2) NOT NULL ,
    ID_RODZAJ 			   NUMBER (6) NOT NULL
  ) ;
ALTER TABLE PRACA ADD CONSTRAINT PRACA_PK PRIMARY KEY ( ID_PRACY ) ;


CREATE TABLE RODZAJ_PRACY
  (
    ID_RODZAJ        NUMBER (6) NOT NULL ,
    NAZWA_RODZAJU    VARCHAR2 (30) NOT NULL ,
    STAWKA_GODZINOWA NUMBER (6,2) NOT NULL
  ) ;
ALTER TABLE RODZAJ_PRACY ADD CONSTRAINT RODZAJ_PRACY_PK PRIMARY KEY ( ID_RODZAJ ) ;


CREATE TABLE ROZLICZENIE
  (
    ID_ROZLICZENIA      NUMBER (6) NOT NULL ,
	ID_WIEZNIA  		NUMBER (6) NOT NULL,
    DATA_WYSTAWIENIA    DATE NOT NULL ,
	CENA_ZA_DZ_PRACY    NUMBER (6,2) NOT NULL,
    WARTOSC_ROZLICZENIA NUMBER (6,2) NOT NULL ,
	ID_PLACOWKI			NUMBER  (6) NOT NULL
      ) ;
ALTER TABLE ROZLICZENIE ADD CONSTRAINT ROZLICZENIE_PK PRIMARY KEY ( ID_ROZLICZENIA ) ;


CREATE TABLE UDOGODNIENIA
  (
    ID_UDOGODNIENIA    NUMBER (3) NOT NULL ,
    NAZWA_UDOGODNIENIA VARCHAR2 (30) NOT NULL ,
    CENA               NUMBER (6,2) NOT NULL
  ) ;
ALTER TABLE UDOGODNIENIA ADD CONSTRAINT UDOGODNIENIA_PK PRIMARY KEY ( ID_UDOGODNIENIA ) ;


CREATE TABLE WIEZIEN
  (
    ID_WIEZNIA           NUMBER (6) NOT NULL ,
    IMIE                 VARCHAR2 (20) NOT NULL ,
    NAZWISKO             VARCHAR2 (30) NOT NULL ,
    PESEL                NUMBER (11) NOT NULL ,
    DATA_PRZYJECIA       DATE NOT NULL ,
    DATA_WYJSCIA         DATE ,
    ID_PRACY       		 NUMBER (6) NOT NULL ,
    ID_PLACOWKI 		 NUMBER (6) NOT NULL
  ) ;
ALTER TABLE WIEZIEN ADD CONSTRAINT WIEZIEN_PK PRIMARY KEY ( ID_WIEZNIA ) ;


ALTER TABLE WIEZIEN ADD CONSTRAINT PLACOWKA_FK FOREIGN KEY ( ID_PLACOWKI ) REFERENCES PLACOWKA ( ID_PLACOWKI ) ;

ALTER TABLE WIEZIEN ADD CONSTRAINT PRACA_FK FOREIGN KEY ( ID_PRACY ) REFERENCES PRACA ( ID_PRACY ) ;

ALTER TABLE PRACA ADD CONSTRAINT RODZAJ_PRACY_FK FOREIGN KEY ( ID_RODZAJ ) REFERENCES RODZAJ_PRACY ( ID_RODZAJ ) ;

ALTER TABLE DETALE_ROZLICZENIA ADD CONSTRAINT ROZLICZENIE_FK FOREIGN KEY ( ID_ROZLICZENIA ) REFERENCES ROZLICZENIE ( ID_ROZLICZENIA ) ;

ALTER TABLE DETALE_ROZLICZENIA ADD CONSTRAINT UDOGODNIENIA_FK FOREIGN KEY ( ID_UDOGODNIENIA ) REFERENCES UDOGODNIENIA ( ID_UDOGODNIENIA ) ;

ALTER TABLE ROZLICZENIE ADD CONSTRAINT WIEZIEN_FK FOREIGN KEY ( ID_WIEZNIA ) REFERENCES WIEZIEN ( ID_WIEZNIA ) ;


--inserty

INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('1','Warsztat','9');
INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('2','Mycie wychodka','5');
INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('3','Mycie podłóg','5');
INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('4','Pranie','6');
INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('5','Wywóz śmieci','5');
INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('6','Kamieniołom','11');
INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('7','Sprzątanie w kuchni','8');
INSERT INTO RODZAJ_PRACY (ID_RODZAJ,NAZWA_RODZAJU,STAWKA_GODZINOWA) VALUES ('8','Gotowanie','9');

INSERT INTO PLACOWKA (ID_PLACOWKI,NAZWA_PLACOWKI,ULICA,MIEJSCOWOSC,KRAJ) VALUES ('1','San Quentin','Deathhill','San Franciso','USA');
INSERT INTO PLACOWKA (ID_PLACOWKI,NAZWA_PLACOWKI,ULICA,MIEJSCOWOSC,KRAJ) VALUES ('2','Alcatraz','Ocean St.','San Francisco','USA');
INSERT INTO PLACOWKA (ID_PLACOWKI,NAZWA_PLACOWKI,ULICA,MIEJSCOWOSC,KRAJ) VALUES ('3','La Sante','Quesadilas','Santino','Paryż');

INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('1','6','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('2','7','8');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('3','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('4','5','1');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('5','7','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('6','7','5');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('7','9','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('8','6','7');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('9','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('10','6','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('11','7','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('12','5','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('13','6','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('14','7','8');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('15','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('16','5','1');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('17','7','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('18','7','5');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('19','9','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('20','6','7');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('21','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('22','6','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('23','7','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('24','5','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('25','9','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('26','6','7');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('27','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('28','6','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('29','7','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('30','5','3');

INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('31','6','1');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('32','7','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('33','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('34','5','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('35','7','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('36','7','5');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('37','9','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('38','6','8');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('39','10','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('40','6','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('41','7','5');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('42','5','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('43','6','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('44','7','8');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('45','10','8');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('46','5','1');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('47','7','8');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('48','7','5');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('49','9','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('50','6','8');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('51','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('52','6','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('53','7','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('54','5','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('55','9','1');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('56','6','7');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('57','10','4');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('58','6','2');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('59','7','3');
INSERT INTO PRACA (ID_PRACY,CZAS_PRACY_DZ,ID_RODZAJ) VALUES ('60','5','2');

INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('1','Ręcznik','3');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('2','Łóżko','5');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('3','Śniadanie','5');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('4','Obiad','6');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('5','Kolacja','7');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('6','Buty','4');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('7','Piżama','2');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('8','Płyn do kąpieli','2');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('9','Wstęp na siłownie','6');
INSERT INTO UDOGODNIENIA (ID_UDOGODNIENIA,NAZWA_UDOGODNIENIA,CENA) VALUES ('10','Wstęp na boisko','9');

--sekwencje

CREATE   SEQUENCE SEQ_DETALE_ROZLICZENIA INCREMENT BY 1 MAXVALUE 99999999999999999 MINVALUE 0 START WITH 1 NOCACHE ORDER;
CREATE   SEQUENCE SEQ_FAKTURY_LICZNIK_POCZ INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCACHE ORDER;
CREATE   SEQUENCE SEQ_ROZLICZENIE INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 START WITH 1 NOCACHE ORDER;
CREATE   SEQUENCE WIEZIEN_IN INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 START WITH 1 NOCACHE ORDER;


INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Mariusz','Cieślak','89213319261','72/02/15','18/05/30',1,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Marek','Cieśla','54173898782','62/08/16','18/04/30',2,2);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Piotr','Strzałkowski','80793351440','52/01/17','18/06/30',3,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Albert','Strzałkowowski','65407333588','42/02/15','18/07/30',1,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Krzysztof','Kowal','76256134324','78/03/18','18/08/30',2,5);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Piotr','Kowalski','11747891967','73/04/19','18/08/30',3,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Grzegorz','Grabowski','46570929705','71/05/05','18/09/30',1,7);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Mikołaj','Celiński','95208640152','69/06/05','18/03/30',2,8);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Zbigniew','Celoch','90989176923','75/07/18','25/02/26',3,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Grzanka','49332212818','82/09/22','25/02/12',1,2);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Grzelak','52777882083','72/02/25','48/01/30',2,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Obozowski','56314916356','77/12/05','38/01/30',3,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Abacki','69891172084','79/11/12','25/06/30',1,5);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Jakub','Radomski','85264573889','92/01/13','25/10/30',2,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Joachim','Kowalski','52421056616','72/01/11','30/10/30',3,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Aleksander','Kowalczyk','51778077453','72/03/17','25/11/30',1,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tadeusz','Gołębiewski','62829108028','72/06/18','20/12/30',2,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Wojciech','Gołębiewski','55950621273','72/08/28','19/10/30',3,8);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Kareem','Xanthus','62092452581','72/09/15','18/06/30',1,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Bryar','Martin','52101930371','77/09/28','25/11/20',3,2);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Alvin','Gareth','35047790143','64/12/17','25/08/17',3,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Emery','Jelani','41052368398','96/11/20','25/07/27',3,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Nerea','Arthur','47082880571','61/02/23','51/02/27',3,5);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Cheyenne','Hector','44121195554','70/03/22','25/08/11',3,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Jane','Emerson','51091871652','74/06/01','42/09/24',1,7);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Gemma','Fritz','45030759945','67/03/08','25/05/14',2,8);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Adara','Xnthus','54081785567','78/03/30','26/07/15',1,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Elmo','Xanthus','50031172921','76/06/20','55/03/12',3,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Priscilla','Nasim','37062958644','51/01/23','25/10/16',1,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Bruno','Brent','44100422694','78/01/12','25/04/10',2,2);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Piotr','Mazgaj','89213319654','17/02/11','41/05/30',1,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Marek','Babacki','74173898346','17/02/11','43/04/30',2,2);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Piotr','Pitruszka','80793351555','17/02/11','35/06/30',3,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Albert','Kalkowski','85407338476','17/02/11','33/07/30',1,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Krzysztof','Kołodziej','76256137643','17/02/11','60/08/30',2,5);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Piotr','Zawadzki','81747893478','17/02/11','50/08/30',3,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Grzegorz','Zawacki','76570925555','17/02/11','25/09/30',1,7);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Mikołaj','Krysiak','85208646666','17/02/11','24/03/30',2,8);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Zbigniew','Kocioł','80989178888','17/02/11','19/02/26',3,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Skarpeta','79332219009','17/02/11','19/02/12',1,2);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Garnok','82777882334','17/02/11','48/01/30',2,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Mazur','76314917889','17/02/11','38/01/30',3,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tomasz','Obozowski','79891170088','17/02/11','35/06/30',1,5);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Jakub','Wiśniewski','85264575342','17/02/11','22/10/30',2,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Joachim','Biloński','82421057789','17/02/11','31/10/30',3,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Aleksander','Kwiatkowski','81778073321','17/02/11','25/11/30',1,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Tadeusz','Duda','82829108756','17/02/11','20/12/30',2,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Wojciech','Szymański','75950620099','19/02/11','20/10/30',3,8);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Seweryn','Szymkowiak','72092455567','17/02/11','19/06/30',1,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Remigiusz','Piotrowski','82101939867','17/02/11','26/11/20',3,2);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Aloizy','Swat','75047793211','17/02/11','37/08/17',3,3);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Ferdynand','Elp','81052361122','17/02/11','26/07/27',3,4);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Michal','Gatr','77082882233','17/02/11','24/02/27',3,5);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Kamil','Potok','74121195554','17/02/11','23/08/11',3,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Bartosz','Strumyk','81091875643','17/02/11','42/09/24',1,7);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Mariusz','Niedzielski','75030755467','17/02/11','56/05/14',2,8);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Grzegorz','Prokop','84081787777','17/02/11','26/07/15',1,6);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Eryk','Tadla','76031174532','17/02/11','37/03/12',3,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Ernest','Chołownia','77062958853','17/02/11','19/10/16',1,1);
INSERT INTO WIEZIEN (ID_WIEZNIA,IMIE,NAZWISKO,PESEL,DATA_PRZYJECIA,DATA_WYJSCIA,ID_PLACOWKI,ID_PRACY) VALUES(WIEZIEN_IN.nextval,'Artur','Krajewski','84100427531','17/02/11','26/04/10',2,2);

--perspektywy
CREATE OR REPLACE VIEW ILU_WIEZNIOW_W_1_PLACOWCE AS
select count(*) as "Ilość Więźniów" from WIEZIEN
where ID_PLACOWKI=1;

CREATE OR REPLACE VIEW ILU_WIEZNIOW_W_2_PLACOWCE AS
select count(*) as "Ilość Więźniów" from WIEZIEN
where ID_PLACOWKI=2;

CREATE OR REPLACE VIEW ILU_WIEZNIOW_W_3_PLACOWCE AS
select count(*) as "Ilość Więźniów" from WIEZIEN
where ID_PLACOWKI=3;

CREATE OR REPLACE VIEW ZAROBEK_1_PLACOWKI AS
select sum(WARTOSC_ROZLICZENIA) as "Zarobek" from ROZLICZENIE
where ID_PLACOWKI=1;

CREATE OR REPLACE VIEW ZAROBEK_2_PLACOWKI AS
select sum(WARTOSC_ROZLICZENIA) as "Zarobek" from ROZLICZENIE
where ID_PLACOWKI=2;

CREATE OR REPLACE VIEW ZAROBEK_3_PLACOWKI AS
select sum(WARTOSC_ROZLICZENIA) as "Zarobek" from ROZLICZENIE
where ID_PLACOWKI=3;

CREATE OR REPLACE VIEW OGOLNY_ZAROBEK_PLACOWEK AS
select sum(WARTOSC_ROZLICZENIA) as "Zarobek" from ROZLICZENIE;


CREATE OR REPLACE VIEW ZAROBEK_WIEZNIOW AS
select distinct IMIE ||' '|| NAZWISKO as "Imie i Nazwisko", CENA_ZA_DZ_PRACY as Kwota 
from WIEZIEN, ROZLICZENIE
where WIEZIEN.ID_WIEZNIA = ROZLICZENIE.ID_WIEZNIA
order by CENA_ZA_DZ_PRACY;


CREATE OR REPLACE VIEW TOP_5_DOCHODOWYCH_WIEZNIOW AS
select distinct IMIE ||' '|| NAZWISKO as "Imie i Nazwisko", WARTOSC_ROZLICZENIA as Zysk
from WIEZIEN, ROZLICZENIE
where WIEZIEN.ID_WIEZNIA = ROZLICZENIE.ID_WIEZNIA AND rownum<=5
order by ROZLICZENIE.WARTOSC_ROZLICZENIA desc;

create or replace view Rozliczenia as
select  NAZWA_PLACOWKI as "Nazwa Placówki",ULICA as Ulica,MIEJSCOWOSC as Miejscowość,KRAJ as Kraj, ROZLICZENIE.ID_ROZLICZENIA as "Numer Rozliczenia",IMIE ||' '||NAZWISKO as "Imię i Nazwisko",ROZLICZENIE.ID_WIEZNIA as "Numer więźnia",NAZWA_UDOGODNIENIA as "Nazwa udogodnienia", DATA_WYSTAWIENIA,POZYCJA as Pozycja, LICZBA_UDOGODNIEN as Liczba,CENA_ZA_UDOGODNIENIA as Cena,CENA_ZA_DZ_PRACY as "Dzienny zarobek więźnia",WARTOSC_ROZLICZENIA as Wartość
from ROZLICZENIE,WIEZIEN,PLACOWKA,DETALE_ROZLICZENIA,UDOGODNIENIA
where ROZLICZENIE.ID_WIEZNIA=WIEZIEN.ID_WIEZNIA AND ROZLICZENIE.ID_PLACOWKI=PLACOWKA.ID_PLACOWKI AND ROZLICZENIE.ID_ROZLICZENIA=DETALE_ROZLICZENIA.ID_ROZLICZENIA AND DETALE_ROZLICZENIA.ID_UDOGODNIENIA=UDOGODNIENIA.ID_UDOGODNIENIA;



--funkcje

create or replace FUNCTION FN_ILE_FAKTUR RETURN NUMBER AS 
wynik number:=0;
BEGIN

select count(*) into wynik from ROZLICZENIE;

  RETURN wynik;
END FN_ILE_FAKTUR;

/

create or replace FUNCTION FN_ILOSC_WIEZNIOW 
RETURN NUMBER as
wynik number;
BEGIN
  select count(*) into wynik from WIEZIEN;
  return wynik;
END FN_ILOSC_WIEZNIOW;

/

create or replace FUNCTION FN_LOSUJ RETURN NUMBER AS 
wynik number;
BEGIN
select round (dbms_random.value(1,6),0)into wynik from dual;

  RETURN wynik;
END FN_LOSUJ;

/

create or replace FUNCTION FN_NR_UDOGODNIENIA RETURN NUMBER AS 
wynik number;
BEGIN
select round (dbms_random.value(1,10),0)into wynik from dual;
  RETURN wynik;
END FN_NR_UDOGODNIENIA;

/
--procedury

create or replace PROCEDURE PR_DETALE_I_UPDATE_ROZLICZENIE AS 
--wstawienie do rozliczenia
v_pocz 	  number :=1;
v_koniec    number :=30;
v_wartosc_rozliczenia ROZLICZENIE.WARTOSC_ROZLICZENIA%TYPE;
v_czas   	         PRACA.CZAS_PRACY_DZ%TYPE;
v_stawka 	         RODZAJ_PRACY.STAWKA_GODZINOWA%TYPE;
v_praca  	         PRACA.ID_PRACY%TYPE;
v_rodzaj 	         RODZAJ_PRACY.ID_RODZAJ%TYPE;
v_cena_dnia_pracy    ROZLICZENIE.CENA_ZA_DZ_PRACY%TYPE;
v_nr_rozlicz		 ROZLICZENIE.ID_ROZLICZENIA%TYPE;	
wiezienid number;
numer number;

--update z detalami
v_pocz_petli 	    number :=1;
v_koniec_petli    number :=2;
v_numer_rozliczenia ROZLICZENIE.ID_ROZLICZENIA%TYPE;
v_numer_udogodnienia DETALE_ROZLICZENIA.ID_UDOGODNIENIA%TYPE;
v_cena               UDOGODNIENIA.CENA%TYPE;
v_liczba            number := 1;
v_wartosc           DETALE_ROZLICZENIA.CENA_ZA_UDOGODNIENIA%TYPE;
v_cena_udogodnien  DETALE_ROZLICZENIA.CENA_ZA_UDOGODNIENIA%TYPE;
v_koszt_pracy	   ROZLICZENIE.CENA_ZA_DZ_PRACY%TYPE;

BEGIN

v_koniec:=FN_ILOSC_WIEZNIOW;

for i in v_pocz..v_koniec loop

select STAWKA_GODZINOWA into v_stawka from RODZAJ_PRACY
where ID_RODZAJ =(select ID_RODZAJ from PRACA 
where ID_PRACY = (select ID_PRACY from WIEZIEN
where ID_WIEZNIA=i));

select CZAS_PRACY_DZ into v_czas from PRACA
where ID_PRACY=i;

v_nr_rozlicz:=seq_rozliczenie.nextval;
v_cena_dnia_pracy :=(v_stawka * v_czas);
v_wartosc_rozliczenia:=0;
insert into ROZLICZENIE values (v_nr_rozlicz,i,sysdate,v_cena_dnia_pracy,v_wartosc_rozliczenia,0);


select ID_WIEZNIA into wiezienid from ROZLICZENIE
where ID_ROZLICZENIA =v_nr_rozlicz;

select ID_PLACOWKI into numer from WIEZIEN
where ID_WIEZNIA = wiezienid;

update ROZLICZENIE
set ID_PLACOWKI=numer
where ID_ROZLICZENIA=v_nr_rozlicz;


 v_numer_rozliczenia:=seq_detale_rozliczenia.nextval;

v_koniec_petli:= FN_LOSUJ;

for x in v_pocz_petli..v_koniec_petli loop

v_numer_udogodnienia:=FN_NR_UDOGODNIENIA;

select CENA into v_cena from UDOGODNIENIA
WHERE ID_UDOGODNIENIA=v_numer_udogodnienia;

v_wartosc := (v_cena*v_liczba);

insert into DETALE_ROZLICZENIA values (v_numer_rozliczenia,x,v_numer_udogodnienia,v_liczba,v_wartosc);
  
  end loop;

commit;  
  --czesc update rozliczenia
  
  select sum(CENA_ZA_UDOGODNIENIA) into v_cena_udogodnien from DETALE_ROZLICZENIA
where ID_ROZLICZENIA=v_numer_rozliczenia;

select CENA_ZA_DZ_PRACY into v_koszt_pracy from ROZLICZENIE
where ID_ROZLICZENIA=v_numer_rozliczenia;


update ROZLICZENIE
set WARTOSC_ROZLICZENIA = (v_koszt_pracy - v_cena_udogodnien)
where ID_ROZLICZENIA=v_numer_rozliczenia;

end loop;

commit;
  
END PR_DETALE_I_UPDATE_ROZLICZENIE;



/

--programy

--SCHEDULE

BEGIN
    DBMS_SCHEDULER.CREATE_SCHEDULE (
    	   
      schedule_name  => 'DZIENNIE',
      start_date => sysdate,
      repeat_interval => 'FREQ=DAILY; BYDAY=MON,TUE,WED,THU,FRI,SAT;BYHOUR=18;',
      comments =>'uruchamia wystawianie faktur'
      );
        
END;

--PROGRAM
/

BEGIN
    DBMS_SCHEDULER.create_program(
        program_name => 'FAKTUROWANIE',
        program_action => 'PR_DETALE_I_UPDATE_ROZLICZENIE',
        program_type => 'STORED_PROCEDURE',
        comments => 'wystawianie faktur po dniu',
        enabled => TRUE);
            
END;

/
--JOOOOOOBBBBBB

BEGIN
    DBMS_SCHEDULER.CREATE_JOB 
    (
job_name=> 'ROZLICZENIE_WIEZNIOW',
program_name=>'FAKTUROWANIE',
schedule_name=>'DZIENNIE',
enabled=>true,
comments=>'Wystawia faktury i oblicza wartosc, czyli zysk placowki'


);
END;
/
execute PR_DETALE_I_UPDATE_ROZLICZENIE;

commit;